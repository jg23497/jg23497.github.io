"use strict";(self.webpackChunkjgulan=self.webpackChunkjgulan||[]).push([[116],{9382:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>s,default:()=>u,frontMatter:()=>o,metadata:()=>a,toc:()=>h});var r=t(5893),i=t(1151);const o={title:"'Command not found' when running chruby",tags:["engineering"]},s=void 0,a={permalink:"/2024/02/27/chruby-error",source:"@site/blog/2024/02-27-chruby-error/index.mdx",title:"'Command not found' when running chruby",description:"Following the Ruby community\u2019s advice to avoid using the system-installed Ruby instance for development, you",date:"2024-02-27T00:00:00.000Z",formattedDate:"February 27, 2024",tags:[{label:"engineering",permalink:"/tags/engineering"}],readingTime:1.77,hasTruncateMarker:!1,authors:[],frontMatter:{title:"'Command not found' when running chruby",tags:["engineering"]},unlisted:!1,nextItem:{title:"Image Noise Reduction Using DxO PhotoLab",permalink:"/2023/01/25/image-noise-reduction-using-dxo-photolab"}},l={authorsImageUrls:[]},h=[{value:"What happened?",id:"what-happened",level:4},{value:"What next?",id:"what-next",level:4}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",em:"em",h4:"h4",p:"p",pre:"pre",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["Following the Ruby community\u2019s advice to avoid using the system-installed Ruby instance for development, you\r\ninstall ",(0,r.jsx)(n.a,{href:"https://github.com/postmodern/chruby",children:"chruby"})," using the ",(0,r.jsx)(n.a,{href:"https://github.com/postmodern/chruby?tab=readme-ov-file#install",children:"official installation instructions"}),"\r\nand intend to configure your Ruby versions using ",(0,r.jsx)(n.a,{href:"https://github.com/postmodern/ruby-install",children:"ruby-install"}),". After\r\ninstalling chruby, you open a terminal and see the following error when running the command on your Unix-like OS\r\n(Ubuntu Linux or MacOS):"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ chruby\r\nchruby: command not found\n"})}),"\n",(0,r.jsx)(n.h4,{id:"what-happened",children:"What happened?"}),"\n",(0,r.jsxs)(n.p,{children:["Let's take a closer look at what happened. The ",(0,r.jsx)(n.a,{href:"https://github.com/postmodern/chruby/blob/a543a35790e5528b5a67de20e78a7390f5f7606e/scripts/setup.sh#L65",children:"installation script"})," automatically adds a ",(0,r.jsx)(n.em,{children:"/etc/profile.d"})," script at\r\n",(0,r.jsx)(n.em,{children:"/etc/profile.d/chruby.sh"}),". The ",(0,r.jsx)(n.em,{children:"/etc/profile.d"})," scripts are themselves auto-discovered and then executed by the\r\n",(0,r.jsx)(n.em,{children:"/etc/profile"})," script, which one might expect to happen upon logging in:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="Extract from Ubuntu\'s /etc/profile file"',children:"if [ -d /etc/profile.d ]; then\r\n  for i in /etc/profile.d/*.sh; do\r\n    if [ -r $i ]; then\r\n      . $i\r\n    fi\r\n  done\r\n  unset i\r\nfi\n"})}),"\n",(0,r.jsxs)(n.p,{children:["However, ",(0,r.jsx)(n.em,{children:"/etc/profile"})," is invoked only for login shells. A login shell is what we use when logging in via SSH or via a TTY.\r\nOur terminal instance is an interactive non-login shell and so ",(0,r.jsx)(n.em,{children:"/etc/profile"})," is not executed, including our new ",(0,r.jsx)(n.em,{children:"chruby.sh"})," script that\r\nwould have made the chruby command available to our session."]}),"\n",(0,r.jsxs)(n.p,{children:["To make the chruby command available to an interactive shell, we must configure our shell accordingly. For Bash this involves editing the\r\n",(0,r.jsx)(n.em,{children:"~/.bashrc"})," or ",(0,r.jsx)(n.em,{children:"/etc/bash.bashrc"})," files, which are the current user and global configuration scripts for Bash respectively:"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-bash",metastring:'title="~/.bashrc"',children:"source /usr/local/share/chruby/chruby.sh\n"})}),"\n",(0,r.jsxs)(n.p,{children:["For ZSH on MacOS, the equivalent files would be ",(0,r.jsx)(n.em,{children:"~/.zshrc"})," and ",(0,r.jsx)(n.em,{children:"/etc/zshrc"}),". If using a shell other than Bash or ZSH, consult the documentation\r\nto ensure the correct configuration script is updated."]}),"\n",(0,r.jsx)(n.p,{children:"Correctly configured, we now see the following when running chruby:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ chruby\r\n   ruby-3.3.0\n"})}),"\n",(0,r.jsx)(n.h4,{id:"what-next",children:"What next?"}),"\n",(0,r.jsxs)(n.p,{children:["Although the convention for Unix-like application installers is ",(0,r.jsx)(n.em,{children:"not"})," to touch the user's data, the Google Cloud SDK installer asks users\r\nwhether it should update their ",(0,r.jsx)(n.em,{children:"~/.bashrc"})," file as part of the installation process:"]}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsx)(n.p,{children:"Modify profile to update your $PATH and enable bash completion? (Y/n)?"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"The chruby installer could help users by offering to do the same, even if only handling the most popular shells like Bash or ZSH."})]})}function u(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>a,a:()=>s});var r=t(7294);const i={},o=r.createContext(i);function s(e){const n=r.useContext(o);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(o.Provider,{value:n},e.children)}}}]);